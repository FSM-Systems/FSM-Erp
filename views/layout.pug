// This is the main template that sets up the page requirements
// jQuery boostrap etc 

doctype html
html(lang="en")
	head
		meta(charset="utf-8")
		meta(http-equiv="X-UA-Compatible" content="IE=edge")
		meta(name="viewport" content="width=device-width, initial-scale=1")
		meta(name="author" content="fsm.co.tz")
		
		title= title
		
		// Link external libraries (jquery/nprogress etc etc)
		include addons/external_libraries.pug
	body
		block content
		
		// NProgress ajax jQuery
		script.
			$(document).ready(function() {
				// - Setup NProgress bar
				NProgress.configure({ showSpinner: false });
				$(document).ajaxStart(function(){
					NProgress.start()
				});
				
				$(document).ajaxStop(function(){
					NProgress.done()
				});
				
				// - Initialize Datepickers
				$(document).on("focus", ".datepicker", function () {
					$(this).datepicker({dateFormat: "dd/mm/yy"});
				});
				
				// - Initialize tooltips
				$('body').tooltip({
					selector: '.mainmenulink, .btn, .logo, input',
					container: 'body',
					//'delay': { show: 0, hide: 100 }, // Delay showing tooltip as it can be annoying..
					trigger: 'hover',
				});
				
				// Initialize popovers 
				var popOverSettings = {
					placement: 'bottom',
					container: 'body',
					html: true,
					selector: '[data-toggle="popover"]', //Sepcify the selector here
					content: function () {
						return $('#popover-content').html();
					},
				}
				$('body').popover(popOverSettings)
				
				// Close popover when clicking in body
				$('body').on('click', function (e) {
				    $('[data-toggle=popover]').each(function () {
				        // hide any open popovers when the anywhere else in the body is clicked
				        if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {
				            $(this).popover('hide');
				        }
				    });
				});
			})
			
		// - jQuery scripts
		// - Include the database scripts to updat/insert/delete
		include addons/dbscripts.pug
			
		
		// - include the page that contains all button handlers.
		include addons/button_handlers.pug
		
		// - Include the handler to create autocompletes
		include addons/autocomplete_handler.pug